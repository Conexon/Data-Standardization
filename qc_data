--1. check that the standardized columns exist in each table
--if a column does not exist in the table you will receive an error (ex: "ERROR: column 'cn_substat' does not exist")

--substation
select cn_substat, subname
  from schema.table

--meter
select city, cn_feeder, cn_substat, mail_add, scada, serv_loc, state, subname, phy_add
  from schema.table

--electric_span
select cn_feeder, cn_substat, length, ring, ring_size, subtype, subname
  from schema.table
  
--structure
select cn_feeder, cn_substat, structid, subname
  from schema.table
  


--2. check that the data type of all required fields are correct 
--select the table, select SQL on the browser, check that data types match https://github.com/Conexon/data-processing/wiki/Data-Validation-Fields



--3. check fields that CANNOT have null values
--if null values exist in any of these fields, you must fix the data and check again

--substation
select * from schema.table
  where cn_substat is null
  
--meter
select * from table.schema
  where cn_substat is null 
  or cn_feeder is null
  or scada is null

--electric_span
select * from schema.table 
  where cn_feeder is null
  or cn_substat is null
  or length is null
  or ring is null
  or ring_size is null
  or subtype is null
  
--structure
select * from schema.table 
  where cn_feeder is null
  or cn_substat is null
  or structid is null
  
  
 
--4. check fields that can only have specific domain values
--if values other than those allowed are in the data, you must fix the data and check again

--electric_span
select ring, count(*)
  from schema.table
  where not ring = 0
  and not ring = 1
  group by ring
  
select ring_size, count(*)
  from schema.table
  where not ring_size = 0
  and not ring_size = 96
  and not ring_size = 144
  group by ring_size
  
select subtype, count(*)
  from schema.table
  where not subtype = 1
  and not subtype = 2
  and not subtype = 3
  and not subtype = 4
  group by subtype
